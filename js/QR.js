(()=>{const d=101;let t,lt='';const ids=['prcLicense','email','contactNo','cardCompany','cardPosition'];const vis=i=>document.getElementById(i)?.dataset.shown==='1';const build=()=>{const u=JSON.parse(sessionStorage.getItem('userData')||'{}');if(!u?.ok)return'';const p=u.pi||{},L=['BEGIN:VCARD','VERSION:3.0',`FN:${p.n||''}`,'URL:https://uapmnlcorinthian.com'];if(vis('prcLicense'))L.push(`NOTE:PRC ${p.prc||''}`);if(vis('email'))L.push(`EMAIL:${p.e||''}`);if(vis('contactNo')){const c=String(p.c||'').replace(/^0+/,'');if(c)L.push(`TEL:0${c}`)}if(vis('cardCompany'))L.push(`ORG:${p.co||''}`);if(vis('cardPosition'))L.push(`TITLE:${p.po||''}`);L.push('CATEGORIES:Architect,UAP,Manila Corinthian Chapter','END:VCARD');return L.join('\n')};const render=()=>{const s=build();if(!s||s===lt)return;lt=s;const q=document.getElementById('qr-vcard');if(!q)return;q.innerHTML='';new QRCode(q,{text:s,width:300,height:300,correctLevel:QRCode.CorrectLevel.H})};const deb=()=>{clearTimeout(t);t=setTimeout(render,d)};document.addEventListener('DOMContentLoaded',()=>{setTimeout(render,500);document.addEventListener('click',e=>{if(e.target.closest('.toggle-sensitive-btn'))deb()});ids.forEach(id=>{const el=document.getElementById(id);if(!el)return;new MutationObserver(deb).observe(el,{attributes:true,attributeFilter:['data-shown','class','style','hidden']})})})})();

